<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `Signer` struct in crate `trust_dns`.">
    <meta name="keywords" content="rust, rustlang, rust-lang, Signer">

    <title>trust_dns::rr::dnssec::Signer - Rust</title>

    <link rel="stylesheet" type="text/css" href="../../../rustdoc.css">
    <link rel="stylesheet" type="text/css" href="../../../main.css">
    

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <nav class="sidebar">
        
        <p class='location'><a href='../../index.html'>trust_dns</a>::<wbr><a href='../index.html'>rr</a>::<wbr><a href='index.html'>dnssec</a></p><script>window.sidebarCurrent = {name: 'Signer', ty: 'struct', relpath: ''};</script><script defer src="sidebar-items.js"></script>
    </nav>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content struct">
<h1 class='fqn'><span class='in-band'>Struct <a href='../../index.html'>trust_dns</a>::<wbr><a href='../index.html'>rr</a>::<wbr><a href='index.html'>dnssec</a>::<wbr><a class='struct' href=''>Signer</a></span><span class='out-of-band'><span id='render-detail'>
                   <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                       [<span class='inner'>&#x2212;</span>]
                   </a>
               </span><a id='src-3750' class='srclink' href='../../../src/trust_dns/src/rr/dnssec/signer.rs.html#29-35' title='goto source code'>[src]</a></span></h1>
<pre class='rust struct'>pub struct Signer {
    // some fields omitted
}</pre><div class='docblock'><p>Use for performing signing and validation of DNSSec based components.</p>
</div><h2 id='methods'>Methods</h2><h3 class='impl'><code>impl <a class='struct' href='../../../trust_dns/rr/dnssec/struct.Signer.html' title='trust_dns::rr::dnssec::Signer'>Signer</a></code></h3><div class='impl-items'><h4 id='method.new_verifier' class='method'><code>fn <a href='#method.new_verifier' class='fnname'>new_verifier</a>(algorithm: <a class='enum' href='../../../trust_dns/rr/dnssec/enum.Algorithm.html' title='trust_dns::rr::dnssec::Algorithm'>Algorithm</a>, pkey: <a class='struct' href='https://sfackler.github.io/rust-openssl/doc/v0.7.8/openssl/crypto/pkey/struct.PKey.html' title='openssl::crypto::pkey::PKey'>PKey</a>, signer_name: <a class='struct' href='../../../trust_dns/rr/domain/struct.Name.html' title='trust_dns::rr::domain::Name'>Name</a>) -&gt; Self</code></h4>
<div class='docblock'><p>Version of Signer for verifying RRSIGs and SIG0 records.</p>
</div><h4 id='method.new' class='method'><code>fn <a href='#method.new' class='fnname'>new</a>(algorithm: <a class='enum' href='../../../trust_dns/rr/dnssec/enum.Algorithm.html' title='trust_dns::rr::dnssec::Algorithm'>Algorithm</a>, pkey: <a class='struct' href='https://sfackler.github.io/rust-openssl/doc/v0.7.8/openssl/crypto/pkey/struct.PKey.html' title='openssl::crypto::pkey::PKey'>PKey</a>, signer_name: <a class='struct' href='../../../trust_dns/rr/domain/struct.Name.html' title='trust_dns::rr::domain::Name'>Name</a>, expiration: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, inception: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>) -&gt; Self</code></h4>
<div class='docblock'><p>Version of Signer for signing RRSIGs and SIG0 records.</p>
</div><h4 id='method.get_algorithm' class='method'><code>fn <a href='#method.get_algorithm' class='fnname'>get_algorithm</a>(&amp;self) -&gt; <a class='enum' href='../../../trust_dns/rr/dnssec/enum.Algorithm.html' title='trust_dns::rr::dnssec::Algorithm'>Algorithm</a></code></h4>
<h4 id='method.get_signer_name' class='method'><code>fn <a href='#method.get_signer_name' class='fnname'>get_signer_name</a>(&amp;self) -&gt; &amp;<a class='struct' href='../../../trust_dns/rr/domain/struct.Name.html' title='trust_dns::rr::domain::Name'>Name</a></code></h4>
<h4 id='method.get_expiration' class='method'><code>fn <a href='#method.get_expiration' class='fnname'>get_expiration</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a></code></h4>
<h4 id='method.get_inception' class='method'><code>fn <a href='#method.get_inception' class='fnname'>get_inception</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a></code></h4>
<h4 id='method.get_pkey' class='method'><code>fn <a href='#method.get_pkey' class='fnname'>get_pkey</a>(&amp;self) -&gt; &amp;<a class='struct' href='https://sfackler.github.io/rust-openssl/doc/v0.7.8/openssl/crypto/pkey/struct.PKey.html' title='openssl::crypto::pkey::PKey'>PKey</a></code></h4>
<h4 id='method.get_public_key' class='method'><code>fn <a href='#method.get_public_key' class='fnname'>get_public_key</a>(&amp;self) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;</code></h4>
<h4 id='method.to_dnskey' class='method'><code>fn <a href='#method.to_dnskey' class='fnname'>to_dnskey</a>(&amp;self, name: <a class='struct' href='../../../trust_dns/rr/domain/struct.Name.html' title='trust_dns::rr::domain::Name'>Name</a>, ttl: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>) -&gt; <a class='struct' href='../../../trust_dns/rr/resource/struct.Record.html' title='trust_dns::rr::resource::Record'>Record</a></code></h4>
<div class='docblock'><p>Creates a Record that represents the public key for this Signer</p>
</div><h4 id='method.calculate_key_tag' class='method'><code>fn <a href='#method.calculate_key_tag' class='fnname'>calculate_key_tag</a>(&amp;self) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u16.html'>u16</a></code></h4>
<div class='docblock'><p>The key tag is calculated as a hash to more quickly lookup a DNSKEY.</p>

<p><a href="https://tools.ietf.org/html/rfc1035">RFC 1035, DOMAIN NAMES - IMPLEMENTATION AND SPECIFICATION, November 1987</a></p>

<pre><code class="language-text">RFC 2535                DNS Security Extensions               March 1999

4.1.6 Key Tag Field

 The &quot;key Tag&quot; is a two octet quantity that is used to efficiently
 select between multiple keys which may be applicable and thus check
 that a public key about to be used for the computationally expensive
 effort to check the signature is possibly valid.  For algorithm 1
 (MD5/RSA) as defined in [RFC 2537], it is the next to the bottom two
 octets of the public key modulus needed to decode the signature
 field.  That is to say, the most significant 16 of the least
 significant 24 bits of the modulus in network (big endian) order. For
 all other algorithms, including private algorithms, it is calculated
 as a simple checksum of the KEY RR as described in Appendix C.

Appendix C: Key Tag Calculation

 The key tag field in the SIG RR is just a means of more efficiently
 selecting the correct KEY RR to use when there is more than one KEY
 RR candidate available, for example, in verifying a signature.  It is
 possible for more than one candidate key to have the same tag, in
 which case each must be tried until one works or all fail.  The
 following reference implementation of how to calculate the Key Tag,
 for all algorithms other than algorithm 1, is in ANSI C.  It is coded
 for clarity, not efficiency.  (See section 4.1.6 for how to determine
 the Key Tag of an algorithm 1 key.)

 /* assumes int is at least 16 bits
    first byte of the key tag is the most significant byte of return
    value
    second byte of the key tag is the least significant byte of
    return value
    */

 int keytag (

         unsigned char key[],  /* the RDATA part of the KEY RR */
         unsigned int keysize, /* the RDLENGTH */
         )
 {
 long int    ac;    /* assumed to be 32 bits or larger */

 for ( ac = 0, i = 0; i &lt; keysize; ++i )
     ac += (i&amp;1) ? key[i] : key[i]&lt;&lt;8;
 ac += (ac&gt;&gt;16) &amp; 0xFFFF;
 return ac &amp; 0xFFFF;
 }
</code></pre>
</div><h4 id='method.sign_message' class='method'><code>fn <a href='#method.sign_message' class='fnname'>sign_message</a>(&amp;self, message: &amp;<a class='struct' href='../../../trust_dns/op/message/struct.Message.html' title='trust_dns::op::message::Message'>Message</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;</code></h4>
<div class='docblock'><p>Signs the given message, returning the signature bytes.</p>

<h1 id='arguments' class='section-header'><a href='#arguments'>Arguments</a></h1>
<ul>
<li><code>message</code> - the message to sign</li>
</ul>

<pre><code class="language-text">4.1.8.1 Calculating Transaction and Request SIGs

 A response message from a security aware server may optionally
 contain a special SIG at the end of the additional information
 section to authenticate the transaction.

 This SIG has a &quot;type covered&quot; field of zero, which is not a valid RR
 type.  It is calculated by using a &quot;data&quot; (see Section 4.1.8) of the
 entire preceding DNS reply message, including DNS header but not the
 IP header and before the reply RR counts have been adjusted for the
 inclusion of any transaction SIG, concatenated with the entire DNS
 query message that produced this response, including the query&#39;s DNS
 header and any request SIGs but not its IP header.  That is

 data = full response (less transaction SIG) | full query

 Verification of the transaction SIG (which is signed by the server
 host key, not the zone key) by the requesting resolver shows that the
 query and response were not tampered with in transit, that the
 response corresponds to the intended query, and that the response
 comes from the queried server.

 A DNS request may be optionally signed by including one or more SIGs
 at the end of the query. Such SIGs are identified by having a &quot;type
 covered&quot; field of zero. They sign the preceding DNS request message
 including DNS header but not including the IP header or any request
 SIGs at the end and before the request RR counts have been adjusted
 for the inclusions of any request SIG(s).

 WARNING: Request SIGs are unnecessary for any currently defined
 request other than update [RFC 2136, 2137] and will cause some old
 DNS servers to give an error return or ignore a query.  However, such
 SIGs may in the future be needed for other requests.

 Except where needed to authenticate an update or similar privileged
 request, servers are not required to check request SIGs.
</code></pre>

<hr>

<p>NOTE: In classic RFC style, this is unclear, it implies that each SIG record is not included in
 the Additional record count, but this makes it more difficult to process and calculate more
 than one SIG0 record. Annoyingly, it means that the Header is signed with different material
 (i.e. additional record count - #SIG0 records), so the exact header sent is NOT the header
 being verified.</p>

<hr>
</div><h4 id='method.verify_message' class='method'><code>fn <a href='#method.verify_message' class='fnname'>verify_message</a>(&amp;self, message: &amp;<a class='struct' href='../../../trust_dns/op/message/struct.Message.html' title='trust_dns::op::message::Message'>Message</a>, signature: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a></code></h4>
<div class='docblock'><p>Verifies a message with the against the given signature</p>

<h1 id='arguments-1' class='section-header'><a href='#arguments-1'>Arguments</a></h1>
<p><code>message</code> - the message to verify
<code>signature</code> - the signature to use for validation</p>

<h1 id='return-value' class='section-header'><a href='#return-value'>Return value</a></h1>
<p><code>true</code> if the message could be validated against the signature, <code>false</code> otherwise</p>
</div><h4 id='method.hash_rrset' class='method'><code>fn <a href='#method.hash_rrset' class='fnname'>hash_rrset</a>(&amp;self, name: &amp;<a class='struct' href='../../../trust_dns/rr/domain/struct.Name.html' title='trust_dns::rr::domain::Name'>Name</a>, dns_class: <a class='enum' href='../../../trust_dns/rr/dns_class/enum.DNSClass.html' title='trust_dns::rr::dns_class::DNSClass'>DNSClass</a>, num_labels: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>, type_covered: <a class='enum' href='../../../trust_dns/rr/record_type/enum.RecordType.html' title='trust_dns::rr::record_type::RecordType'>RecordType</a>, algorithm: <a class='enum' href='../../../trust_dns/rr/dnssec/enum.Algorithm.html' title='trust_dns::rr::dnssec::Algorithm'>Algorithm</a>, original_ttl: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, sig_expiration: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, sig_inception: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u32.html'>u32</a>, key_tag: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u16.html'>u16</a>, signer_name: &amp;<a class='struct' href='../../../trust_dns/rr/domain/struct.Name.html' title='trust_dns::rr::domain::Name'>Name</a>, records: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='struct' href='../../../trust_dns/rr/resource/struct.Record.html' title='trust_dns::rr::resource::Record'>Record</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;</code></h4>
<div class='docblock'><p>name is the the name of the records in the rrset</p>
</div><h4 id='method.hash_rrset_with_rrsig' class='method'><code>fn <a href='#method.hash_rrset_with_rrsig' class='fnname'>hash_rrset_with_rrsig</a>(&amp;self, rrsig: &amp;<a class='struct' href='../../../trust_dns/rr/resource/struct.Record.html' title='trust_dns::rr::resource::Record'>Record</a>, records: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='struct' href='../../../trust_dns/rr/resource/struct.Record.html' title='trust_dns::rr::resource::Record'>Record</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;</code></h4>
<h4 id='method.sign' class='method'><code>fn <a href='#method.sign' class='fnname'>sign</a>(&amp;self, hash: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='struct' href='https://doc.rust-lang.org/nightly/collections/vec/struct.Vec.html' title='collections::vec::Vec'>Vec</a>&lt;<a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a>&gt;</code></h4>
<div class='docblock'><p>Signs a hash.</p>

<p>This will panic if the <code>key</code> is not a private key and can be used for signing.</p>

<h1 id='arguments-2' class='section-header'><a href='#arguments-2'>Arguments</a></h1>
<ul>
<li><code>hash</code> - the hashed resource record set, see <code>hash_rrset</code>.</li>
</ul>

<h1 id='return-value-1' class='section-header'><a href='#return-value-1'>Return value</a></h1>
<p>The signature, ready to be stored in an <code>RData::RRSIG</code>.</p>
</div><h4 id='method.verify' class='method'><code>fn <a href='#method.verify' class='fnname'>verify</a>(&amp;self, hash: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>, signature: <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>&amp;[</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.u8.html'>u8</a><a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.slice.html'>]</a>) -&gt; <a class='primitive' href='https://doc.rust-lang.org/nightly/std/primitive.bool.html'>bool</a></code></h4>
<div class='docblock'><p>Verifies the hash matches the signature with the current <code>key</code>.</p>

<h1 id='arguments-3' class='section-header'><a href='#arguments-3'>Arguments</a></h1>
<ul>
<li><code>hash</code> - the hash to be validated, see <code>hash_rrset</code></li>
<li><code>signature</code> - the signature to use to verify the hash, extracted from an <code>RData::RRSIG</code>
            for example.</li>
</ul>

<h1 id='return-value-2' class='section-header'><a href='#return-value-2'>Return value</a></h1>
<p>True if and only if the signature is valid for the hash. This will always return
false if the <code>key</code>.</p>
</div></div></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <aside id="help" class="hidden">
        <div>
            <h1 class="hidden">Help</h1>

            <div class="shortcuts">
                <h2>Keyboard Shortcuts</h2>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h2>Search Tricks</h2>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>type</code>, <code>macro</code>,
                    and <code>const</code>.
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code> or <code>* -> vec</code>)
                </p>
            </div>
        </div>
    </aside>

    

    <script>
        window.rootPath = "../../../";
        window.currentCrate = "trust_dns";
        window.playgroundUrl = "";
    </script>
    <script src="../../../jquery.js"></script>
    <script src="../../../main.js"></script>
    
    <script defer src="../../../search-index.js"></script>
</body>
</html>